<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Argus Register</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- CSS -->
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:400,100,300,500">
    <link rel="stylesheet" href="../css/bootstrap.css">
    <link rel="stylesheet" href="../css/form.css">
    <link rel="stylesheet" href="../css/Style.css">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

</head>

<body background="../img/backgrounds/1@2x.jpg">
<div class="top-content">
    <div class="inner-bg">
        <div class="container">
            <div class="row">
                <div class="col-sm-7 text">
                    <h1><strong>Argus</strong> Flat Registration Form</h1>
                    <div class="description">
                        <p>
                            This is a free responsive flat registration form made with Bootstrap.
                            Download it on <a href="#"><strong>AZMIND</strong></a>, customize and use it as you like!
                        </p>
                    </div>
                    <div class="top-big-link">
                        <a class="btn btn-link-2" disabled="">Don't have an account?</a>
                        <a class="btn btn-link-1" id="signin">Let me sign in!</a>
                    </div>
                </div>
                <div class="col-sm-5 form-box">
                    <div class="form-top">
                        <div class="form-top-left">
                            <h3>Sign up now</h3>
                            <p>Fill in the form below to get instant access:</p>
                        </div>
                        <div class="form-top-right">
                            <i class="fa fa-pencil"></i>
                        </div>
                        <div class="form-top-divider" ></div>
                    </div>
                    <div class="form-bottom">
                        <form role="form" action="" method="post" class="registration-form">
                            <div class="form-group">
                                <select id="identity" style="    width:300px;" class="form-last-name form-control">
                                    <option value="initiator">任务发布者</option>
                                    <option value="worker">众包工人</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="sr-only" for="username">Username</label>
                                <input type="text"  placeholder="Username" class="form-first-name form-control" id="username" style="    width:300px;">
                            </div>
                            <div class="form-group">
                                <label class="sr-only" for="password">Password</label>
                                <input type="password"  placeholder="Password" class="form-last-name form-control" id="password" style="    width:300px;">
                            </div>

                            <div class="form-group">
                                <label class="sr-only" for="repassword">Password Again</label>
                                <input type="password"  placeholder="Password Again" class="form-last-name form-control" id="repassword" style="    width:300px;">
                            </div>

                        </form>
                        <button id="register" class="btn" style="    width:300px;">Register</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

<script src="../js/jquery-1.8.2.min.js"></script>
<script src="../js/scripts.js"></script>

<script>
    document.getElementById('signin').onclick = function (e) {
        //alert("Hello");
        window.location = 'http://localhost:8080/';
    }
    document.getElementById('register').onclick=function (e) {
        var type =document.getElementById('identity').value;
        var name=document.getElementById('username').value;
        var pw=document.getElementById('password').value;
        var repw=document.getElementById('repassword').value;
        if(name==""||name==null)
            alert('请输入用户名！');
        else if(pw==""||pw==null)
            alert('请输入密码！');
        else if(repw==''||repw==null)
            alert('请重新输入密码！');
        else if(pw!=repw){
            alert('两次输入密码不一致！请重新输入！');
            document.getElementById('password').value="";
            document.getElementById('repassword').value="";
        }
        else{
            //alert("trying to send request")
            var result = register(name,pw,type)
            if(result == "success"){
                alert("注册成功！")
                window.location = "http://localhost:8080/"
            }
            else{
                alert("用户名已被使用，请重新输入！")
                document.getElementById('username').value="";
            }
        }
    }
    function register(username,password,type) {

        var res = null;
        $.ajax({
            url: 'http://localhost:8080/register',
            type: 'post',
            async: false,
            data: {
                username:username,
                password:password,
                type:type
            },
            success: function (data) {
                res = data
            },
            error: function() {
                alert('fail')
            }
        })
        return res
    }
</script>
</body>
</html>